<script>
  const workspace = document.getElementById('workspace');

  let dragging = null;
  let offsetX, offsetY;

  function startDrag(e, element) {
    dragging = element;
    const clientX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
    const clientY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;
    offsetX = clientX - element.offsetLeft;
    offsetY = clientY - element.offsetTop;
    element.style.cursor = 'grabbing';
  }

  function moveDrag(e) {
    if (dragging) {
      const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
      const clientY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
      dragging.style.left = `${clientX - offsetX}px`;
      dragging.style.top = `${clientY - offsetY}px`;
    }
  }

  function endDrag() {
    if (dragging) {
      dragging.style.cursor = 'grab';
      dragging = null;
    }
  }

  // カード生成ループ内
  cardContainer.addEventListener('mousedown', (e) => startDrag(e, cardContainer));
  cardContainer.addEventListener('touchstart', (e) => startDrag(e, cardContainer));

  workspace.addEventListener('mousemove', moveDrag);
  workspace.addEventListener('touchmove', moveDrag);

  workspace.addEventListener('mouseup', endDrag);
  workspace.addEventListener('touchend', endDrag);
</script>
